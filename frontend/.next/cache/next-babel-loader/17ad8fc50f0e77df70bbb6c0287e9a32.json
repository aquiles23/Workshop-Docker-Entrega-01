{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/frontend/pages/editor/new.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport Router from \"next/router\";\nimport React from \"react\";\nimport useSWR from \"swr\";\nimport ListErrors from \"../../components/common/ListErrors\";\nimport TagInput from \"../../components/editor/TagInput\";\nimport ArticleAPI from \"../../lib/api/article\";\nimport storage from \"../../lib/utils/storage\";\nimport editorReducer from \"../../lib/utils/editorReducer\";\n\nvar PublishArticleEditor = function PublishArticleEditor() {\n  _s();\n\n  var initialState = {\n    title: \"\",\n    description: \"\",\n    body: \"\",\n    tagList: []\n  };\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isLoading = _React$useState2[0],\n      setLoading = _React$useState2[1];\n\n  var _React$useState3 = React.useState([]),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      errors = _React$useState4[0],\n      setErrors = _React$useState4[1];\n\n  var _React$useReducer = React.useReducer(editorReducer, initialState),\n      _React$useReducer2 = _slicedToArray(_React$useReducer, 2),\n      posting = _React$useReducer2[0],\n      dispatch = _React$useReducer2[1];\n\n  var _useSWR = useSWR(\"user\", storage),\n      currentUser = _useSWR.data;\n\n  var handleTitle = function handleTitle(e) {\n    return dispatch({\n      type: \"SET_TITLE\",\n      text: e.target.value\n    });\n  };\n\n  var handleDescription = function handleDescription(e) {\n    return dispatch({\n      type: \"SET_DESCRIPTION\",\n      text: e.target.value\n    });\n  };\n\n  var handleBody = function handleBody(e) {\n    return dispatch({\n      type: \"SET_BODY\",\n      text: e.target.value\n    });\n  };\n\n  var addTag = function addTag(tag) {\n    return dispatch({\n      type: \"ADD_TAG\",\n      tag: tag\n    });\n  };\n\n  var removeTag = function removeTag(tag) {\n    return dispatch({\n      type: \"REMOVE_TAG\",\n      tag: tag\n    });\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var _yield$ArticleAPI$cre, data, status;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              setLoading(true);\n              _context.next = 4;\n              return ArticleAPI.create(posting, currentUser === null || currentUser === void 0 ? void 0 : currentUser.token);\n\n            case 4:\n              _yield$ArticleAPI$cre = _context.sent;\n              data = _yield$ArticleAPI$cre.data;\n              status = _yield$ArticleAPI$cre.status;\n              setLoading(false);\n\n              if (status !== 200) {\n                setErrors(data.errors);\n              }\n\n              Router.push(\"/\");\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: \"editor-page\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"container page\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"row\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"col-md-10 offset-md-1 col-xs-12\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 11\n    }\n  }, __jsx(ListErrors, {\n    errors: errors,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 13\n    }\n  }), __jsx(\"form\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }\n  }, __jsx(\"fieldset\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 15\n    }\n  }, __jsx(\"fieldset\", {\n    className: \"form-group\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 17\n    }\n  }, __jsx(\"input\", {\n    className: \"form-control form-control-lg\",\n    type: \"text\",\n    placeholder: \"Article Title\",\n    value: posting.title,\n    onChange: handleTitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 19\n    }\n  })), __jsx(\"fieldset\", {\n    className: \"form-group\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 17\n    }\n  }, __jsx(\"input\", {\n    className: \"form-control\",\n    type: \"text\",\n    placeholder: \"What's this article about?\",\n    value: posting.description,\n    onChange: handleDescription,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 19\n    }\n  })), __jsx(\"fieldset\", {\n    className: \"form-group\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 17\n    }\n  }, __jsx(\"textarea\", {\n    className: \"form-control\",\n    rows: 8,\n    placeholder: \"Write your article (in markdown)\",\n    value: posting.body,\n    onChange: handleBody,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 19\n    }\n  })), __jsx(TagInput, {\n    tagList: posting.tagList,\n    addTag: addTag,\n    removeTag: removeTag,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 17\n    }\n  }), __jsx(\"button\", {\n    className: \"btn btn-lg pull-xs-right btn-primary\",\n    type: \"button\",\n    disabled: isLoading,\n    onClick: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }\n  }, \"Publish Article\")))))));\n};\n\n_s(PublishArticleEditor, \"+OzwxTpz6EN+dVv+J1a15/JIhOc=\", false, function () {\n  return [useSWR];\n});\n\n_c = PublishArticleEditor;\nexport default PublishArticleEditor;\n\nvar _c;\n\n$RefreshReg$(_c, \"PublishArticleEditor\");","map":{"version":3,"sources":["/frontend/pages/editor/new.tsx"],"names":["Router","React","useSWR","ListErrors","TagInput","ArticleAPI","storage","editorReducer","PublishArticleEditor","initialState","title","description","body","tagList","useState","isLoading","setLoading","errors","setErrors","useReducer","posting","dispatch","currentUser","data","handleTitle","e","type","text","target","value","handleDescription","handleBody","addTag","tag","removeTag","handleSubmit","preventDefault","create","token","status","push"],"mappings":"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","sourcesContent":["import Router from \"next/router\";\nimport React from \"react\";\nimport useSWR from \"swr\";\n\nimport ListErrors from \"../../components/common/ListErrors\";\nimport TagInput from \"../../components/editor/TagInput\";\nimport ArticleAPI from \"../../lib/api/article\";\nimport storage from \"../../lib/utils/storage\";\nimport editorReducer from \"../../lib/utils/editorReducer\";\n\nconst PublishArticleEditor = () => {\n  const initialState = {\n    title: \"\",\n    description: \"\",\n    body: \"\",\n    tagList: [],\n  };\n\n  const [isLoading, setLoading] = React.useState(false);\n  const [errors, setErrors] = React.useState([]);\n  const [posting, dispatch] = React.useReducer(editorReducer, initialState);\n  const { data: currentUser } = useSWR(\"user\", storage);\n\n  const handleTitle = (e) =>\n    dispatch({ type: \"SET_TITLE\", text: e.target.value });\n  const handleDescription = (e) =>\n    dispatch({ type: \"SET_DESCRIPTION\", text: e.target.value });\n  const handleBody = (e) =>\n    dispatch({ type: \"SET_BODY\", text: e.target.value });\n  const addTag = (tag) => dispatch({ type: \"ADD_TAG\", tag: tag });\n  const removeTag = (tag) => dispatch({ type: \"REMOVE_TAG\", tag: tag });\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n\n    const { data, status } = await ArticleAPI.create(\n      posting,\n      currentUser?.token\n    );\n\n    setLoading(false);\n\n    if (status !== 200) {\n      setErrors(data.errors);\n    }\n\n    Router.push(\"/\");\n  };\n\n  return (\n    <div className=\"editor-page\">\n      <div className=\"container page\">\n        <div className=\"row\">\n          <div className=\"col-md-10 offset-md-1 col-xs-12\">\n            <ListErrors errors={errors} />\n            <form>\n              <fieldset>\n                <fieldset className=\"form-group\">\n                  <input\n                    className=\"form-control form-control-lg\"\n                    type=\"text\"\n                    placeholder=\"Article Title\"\n                    value={posting.title}\n                    onChange={handleTitle}\n                  />\n                </fieldset>\n\n                <fieldset className=\"form-group\">\n                  <input\n                    className=\"form-control\"\n                    type=\"text\"\n                    placeholder=\"What's this article about?\"\n                    value={posting.description}\n                    onChange={handleDescription}\n                  />\n                </fieldset>\n\n                <fieldset className=\"form-group\">\n                  <textarea\n                    className=\"form-control\"\n                    rows={8}\n                    placeholder=\"Write your article (in markdown)\"\n                    value={posting.body}\n                    onChange={handleBody}\n                  />\n                </fieldset>\n\n                <TagInput\n                  tagList={posting.tagList}\n                  addTag={addTag}\n                  removeTag={removeTag}\n                />\n\n                <button\n                  className=\"btn btn-lg pull-xs-right btn-primary\"\n                  type=\"button\"\n                  disabled={isLoading}\n                  onClick={handleSubmit}\n                >\n                  Publish Article\n                </button>\n              </fieldset>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PublishArticleEditor;\n"]},"metadata":{},"sourceType":"module"}