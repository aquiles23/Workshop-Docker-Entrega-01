{"ast":null,"code":"var _jsxFileName = \"/frontend/pages/profile/[pid].tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useRouter } from \"next/router\";\nimport React from \"react\";\nimport useSWR, { mutate, trigger } from \"swr\";\nimport ArticleList from \"../../components/article/ArticleList\";\nimport CustomImage from \"../../components/common/CustomImage\";\nimport ErrorMessage from \"../../components/common/ErrorMessage\";\nimport Maybe from \"../../components/common/Maybe\";\nimport EditProfileButton from \"../../components/profile/EditProfileButton\";\nimport FollowUserButton from \"../../components/profile/FollowUserButton\";\nimport ProfileTab from \"../../components/profile/ProfileTab\";\nimport UserAPI from \"../../lib/api/user\";\nimport checkLogin from \"../../lib/utils/checkLogin\";\nimport { SERVER_BASE_URL } from \"../../lib/utils/constant\";\nimport fetcher from \"../../lib/utils/fetcher\";\nimport storage from \"../../lib/utils/storage\";\n\nconst Profile = ({\n  initialProfile\n}) => {\n  const router = useRouter();\n  const {\n    query: {\n      pid\n    }\n  } = router;\n  const {\n    data: fetchedProfile,\n    error: profileError\n  } = useSWR(`${SERVER_BASE_URL}/profiles/${encodeURIComponent(String(pid))}`, fetcher, {\n    initialData: initialProfile\n  });\n  if (profileError) return __jsx(ErrorMessage, {\n    message: \"Can't load profile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 28\n    }\n  });\n  const {\n    profile\n  } = fetchedProfile || initialProfile;\n  const {\n    username,\n    bio,\n    image,\n    following\n  } = profile;\n  const {\n    data: currentUser\n  } = useSWR(\"user\", storage);\n  const isLoggedIn = checkLogin(currentUser);\n  const isUser = currentUser && username === (currentUser === null || currentUser === void 0 ? void 0 : currentUser.username);\n\n  const handleFollow = async () => {\n    mutate(`${SERVER_BASE_URL}/profiles/${pid}`, {\n      profile: _objectSpread(_objectSpread({}, profile), {}, {\n        following: true\n      })\n    }, false);\n    UserAPI.follow(pid);\n    trigger(`${SERVER_BASE_URL}/profiles/${pid}`);\n  };\n\n  const handleUnfollow = async () => {\n    mutate(`${SERVER_BASE_URL}/profiles/${pid}`, {\n      profile: _objectSpread(_objectSpread({}, profile), {}, {\n        following: true\n      })\n    }, true);\n    UserAPI.unfollow(pid);\n    trigger(`${SERVER_BASE_URL}/profiles/${pid}`);\n  };\n\n  return __jsx(\"div\", {\n    className: \"profile-page\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"user-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"col-xs-12 col-md-10 offset-md-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }\n  }, __jsx(CustomImage, {\n    src: image,\n    alt: \"User's profile image\",\n    className: \"user-img\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 15\n    }\n  }), __jsx(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 15\n    }\n  }, username), __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 15\n    }\n  }, bio), __jsx(EditProfileButton, {\n    isUser: isUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 15\n    }\n  }), __jsx(Maybe, {\n    test: isLoggedIn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 15\n    }\n  }, __jsx(FollowUserButton, {\n    isUser: isUser,\n    username: username,\n    following: following,\n    follow: handleFollow,\n    unfollow: handleUnfollow,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 17\n    }\n  })))))), __jsx(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"col-xs-12 col-md-10 offset-md-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"articles-toggle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, __jsx(ProfileTab, {\n    profile: profile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 15\n    }\n  })), __jsx(ArticleList, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  })))));\n};\n\nProfile.getInitialProps = async ({\n  query: {\n    pid\n  }\n}) => {\n  const {\n    data: initialProfile\n  } = await UserAPI.get(pid);\n  return {\n    initialProfile\n  };\n};\n\nexport default Profile;","map":{"version":3,"sources":["/frontend/pages/profile/[pid].tsx"],"names":["useRouter","React","useSWR","mutate","trigger","ArticleList","CustomImage","ErrorMessage","Maybe","EditProfileButton","FollowUserButton","ProfileTab","UserAPI","checkLogin","SERVER_BASE_URL","fetcher","storage","Profile","initialProfile","router","query","pid","data","fetchedProfile","error","profileError","encodeURIComponent","String","initialData","profile","username","bio","image","following","currentUser","isLoggedIn","isUser","handleFollow","follow","handleUnfollow","unfollow","getInitialProps","get"],"mappings":";;;;;;;;;AAAA,SAASA,SAAT,QAA0B,aAA1B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,IAAiBC,MAAjB,EAAyBC,OAAzB,QAAwC,KAAxC;AAEA,OAAOC,WAAP,MAAwB,sCAAxB;AACA,OAAOC,WAAP,MAAwB,qCAAxB;AACA,OAAOC,YAAP,MAAyB,sCAAzB;AACA,OAAOC,KAAP,MAAkB,+BAAlB;AACA,OAAOC,iBAAP,MAA8B,4CAA9B;AACA,OAAOC,gBAAP,MAA6B,2CAA7B;AACA,OAAOC,UAAP,MAAuB,qCAAvB;AACA,OAAOC,OAAP,MAAoB,oBAApB;AACA,OAAOC,UAAP,MAAuB,4BAAvB;AACA,SAASC,eAAT,QAAgC,0BAAhC;AACA,OAAOC,OAAP,MAAoB,yBAApB;AACA,OAAOC,OAAP,MAAoB,yBAApB;;AAEA,MAAMC,OAAO,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAwB;AACtC,QAAMC,MAAM,GAAGnB,SAAS,EAAxB;AACA,QAAM;AACJoB,IAAAA,KAAK,EAAE;AAAEC,MAAAA;AAAF;AADH,MAEFF,MAFJ;AAIA,QAAM;AACJG,IAAAA,IAAI,EAAEC,cADF;AAEJC,IAAAA,KAAK,EAAEC;AAFH,MAGFvB,MAAM,CACP,GAAEY,eAAgB,aAAYY,kBAAkB,CAACC,MAAM,CAACN,GAAD,CAAP,CAAc,EADvD,EAERN,OAFQ,EAGR;AAAEa,IAAAA,WAAW,EAAEV;AAAf,GAHQ,CAHV;AASA,MAAIO,YAAJ,EAAkB,OAAO,MAAC,YAAD;AAAc,IAAA,OAAO,EAAC,oBAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAP;AAElB,QAAM;AAAEI,IAAAA;AAAF,MAAcN,cAAc,IAAIL,cAAtC;AACA,QAAM;AAAEY,IAAAA,QAAF;AAAYC,IAAAA,GAAZ;AAAiBC,IAAAA,KAAjB;AAAwBC,IAAAA;AAAxB,MAAsCJ,OAA5C;AAEA,QAAM;AAAEP,IAAAA,IAAI,EAAEY;AAAR,MAAwBhC,MAAM,CAAC,MAAD,EAASc,OAAT,CAApC;AACA,QAAMmB,UAAU,GAAGtB,UAAU,CAACqB,WAAD,CAA7B;AACA,QAAME,MAAM,GAAGF,WAAW,IAAIJ,QAAQ,MAAKI,WAAL,aAAKA,WAAL,uBAAKA,WAAW,CAAEJ,QAAlB,CAAtC;;AAEA,QAAMO,YAAY,GAAG,YAAY;AAC/BlC,IAAAA,MAAM,CACH,GAAEW,eAAgB,aAAYO,GAAI,EAD/B,EAEJ;AAAEQ,MAAAA,OAAO,kCAAOA,OAAP;AAAgBI,QAAAA,SAAS,EAAE;AAA3B;AAAT,KAFI,EAGJ,KAHI,CAAN;AAKArB,IAAAA,OAAO,CAAC0B,MAAR,CAAejB,GAAf;AACAjB,IAAAA,OAAO,CAAE,GAAEU,eAAgB,aAAYO,GAAI,EAApC,CAAP;AACD,GARD;;AAUA,QAAMkB,cAAc,GAAG,YAAY;AACjCpC,IAAAA,MAAM,CACH,GAAEW,eAAgB,aAAYO,GAAI,EAD/B,EAEJ;AAAEQ,MAAAA,OAAO,kCAAOA,OAAP;AAAgBI,QAAAA,SAAS,EAAE;AAA3B;AAAT,KAFI,EAGJ,IAHI,CAAN;AAKArB,IAAAA,OAAO,CAAC4B,QAAR,CAAiBnB,GAAjB;AACAjB,IAAAA,OAAO,CAAE,GAAEU,eAAgB,aAAYO,GAAI,EAApC,CAAP;AACD,GARD;;AAUA,SACE;AAAK,IAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,iCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,WAAD;AACE,IAAA,GAAG,EAAEW,KADP;AAEE,IAAA,GAAG,EAAC,sBAFN;AAGE,IAAA,SAAS,EAAC,UAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAME;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAKF,QAAL,CANF,EAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAIC,GAAJ,CAPF,EAQE,MAAC,iBAAD;AAAmB,IAAA,MAAM,EAAEK,MAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IARF,EASE,MAAC,KAAD;AAAO,IAAA,IAAI,EAAED,UAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,gBAAD;AACE,IAAA,MAAM,EAAEC,MADV;AAEE,IAAA,QAAQ,EAAEN,QAFZ;AAGE,IAAA,SAAS,EAAEG,SAHb;AAIE,IAAA,MAAM,EAAEI,YAJV;AAKE,IAAA,QAAQ,EAAEE,cALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CATF,CADF,CADF,CADF,CADF,EA2BE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,iCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,UAAD;AAAY,IAAA,OAAO,EAAEV,OAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,EAIE,MAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJF,CADF,CADF,CA3BF,CADF;AAwCD,CApFD;;AAsFAZ,OAAO,CAACwB,eAAR,GAA0B,OAAO;AAAErB,EAAAA,KAAK,EAAE;AAAEC,IAAAA;AAAF;AAAT,CAAP,KAA8B;AACtD,QAAM;AAAEC,IAAAA,IAAI,EAAEJ;AAAR,MAA2B,MAAMN,OAAO,CAAC8B,GAAR,CAAYrB,GAAZ,CAAvC;AACA,SAAO;AAAEH,IAAAA;AAAF,GAAP;AACD,CAHD;;AAKA,eAAeD,OAAf","sourcesContent":["import { useRouter } from \"next/router\";\nimport React from \"react\";\nimport useSWR, { mutate, trigger } from \"swr\";\n\nimport ArticleList from \"../../components/article/ArticleList\";\nimport CustomImage from \"../../components/common/CustomImage\";\nimport ErrorMessage from \"../../components/common/ErrorMessage\";\nimport Maybe from \"../../components/common/Maybe\";\nimport EditProfileButton from \"../../components/profile/EditProfileButton\";\nimport FollowUserButton from \"../../components/profile/FollowUserButton\";\nimport ProfileTab from \"../../components/profile/ProfileTab\";\nimport UserAPI from \"../../lib/api/user\";\nimport checkLogin from \"../../lib/utils/checkLogin\";\nimport { SERVER_BASE_URL } from \"../../lib/utils/constant\";\nimport fetcher from \"../../lib/utils/fetcher\";\nimport storage from \"../../lib/utils/storage\";\n\nconst Profile = ({ initialProfile }) => {\n  const router = useRouter();\n  const {\n    query: { pid },\n  } = router;\n\n  const {\n    data: fetchedProfile,\n    error: profileError,\n  } = useSWR(\n    `${SERVER_BASE_URL}/profiles/${encodeURIComponent(String(pid))}`,\n    fetcher,\n    { initialData: initialProfile }\n  );\n\n  if (profileError) return <ErrorMessage message=\"Can't load profile\" />;\n\n  const { profile } = fetchedProfile || initialProfile;\n  const { username, bio, image, following } = profile;\n\n  const { data: currentUser } = useSWR(\"user\", storage);\n  const isLoggedIn = checkLogin(currentUser);\n  const isUser = currentUser && username === currentUser?.username;\n\n  const handleFollow = async () => {\n    mutate(\n      `${SERVER_BASE_URL}/profiles/${pid}`,\n      { profile: { ...profile, following: true } },\n      false\n    );\n    UserAPI.follow(pid);\n    trigger(`${SERVER_BASE_URL}/profiles/${pid}`);\n  };\n\n  const handleUnfollow = async () => {\n    mutate(\n      `${SERVER_BASE_URL}/profiles/${pid}`,\n      { profile: { ...profile, following: true } },\n      true\n    );\n    UserAPI.unfollow(pid);\n    trigger(`${SERVER_BASE_URL}/profiles/${pid}`);\n  };\n\n  return (\n    <div className=\"profile-page\">\n      <div className=\"user-info\">\n        <div className=\"container\">\n          <div className=\"row\">\n            <div className=\"col-xs-12 col-md-10 offset-md-1\">\n              <CustomImage\n                src={image}\n                alt=\"User's profile image\"\n                className=\"user-img\"\n              />\n              <h4>{username}</h4>\n              <p>{bio}</p>\n              <EditProfileButton isUser={isUser} />\n              <Maybe test={isLoggedIn}>\n                <FollowUserButton\n                  isUser={isUser}\n                  username={username}\n                  following={following}\n                  follow={handleFollow}\n                  unfollow={handleUnfollow}\n                />\n              </Maybe>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container\">\n        <div className=\"row\">\n          <div className=\"col-xs-12 col-md-10 offset-md-1\">\n            <div className=\"articles-toggle\">\n              <ProfileTab profile={profile} />\n            </div>\n            <ArticleList />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nProfile.getInitialProps = async ({ query: { pid } }) => {\n  const { data: initialProfile } = await UserAPI.get(pid);\n  return { initialProfile };\n};\n\nexport default Profile;\n"]},"metadata":{},"sourceType":"module"}