{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/frontend/components/article/ArticleActions.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport Router, { useRouter } from \"next/router\";\nimport React from \"react\";\nimport useSWR, { trigger } from \"swr\";\nimport CustomLink from \"../common/CustomLink\";\nimport checkLogin from \"../../lib/utils/checkLogin\";\nimport ArticleAPI from \"../../lib/api/article\";\nimport { SERVER_BASE_URL } from \"../../lib/utils/constant\";\nimport storage from \"../../lib/utils/storage\";\nimport Maybe from \"../common/Maybe\";\n\nvar ArticleActions = function ArticleActions(_ref) {\n  _s();\n\n  var _article$author;\n\n  var article = _ref.article;\n\n  var _useSWR = useSWR(\"user\", storage),\n      currentUser = _useSWR.data;\n\n  var isLoggedIn = checkLogin(currentUser);\n  var router = useRouter();\n  var pid = router.query.pid;\n\n  var handleDelete = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var result;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (isLoggedIn) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              result = window.confirm(\"Do you really want to delete it?\");\n\n              if (result) {\n                _context.next = 5;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 5:\n              _context.next = 7;\n              return ArticleAPI[\"delete\"](pid, currentUser === null || currentUser === void 0 ? void 0 : currentUser.token);\n\n            case 7:\n              trigger(\"\".concat(SERVER_BASE_URL, \"/articles/\").concat(pid));\n              Router.push(\"/\");\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleDelete() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var canModify = isLoggedIn && (currentUser === null || currentUser === void 0 ? void 0 : currentUser.username) === (article === null || article === void 0 ? void 0 : (_article$author = article.author) === null || _article$author === void 0 ? void 0 : _article$author.username);\n  return __jsx(Maybe, {\n    test: canModify,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 5\n    }\n  }, __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 7\n    }\n  }, __jsx(CustomLink, {\n    href: \"/editor/[pid]\",\n    as: \"/editor/\".concat(article.slug),\n    className: \"btn btn-outline-secondary btn-sm\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 9\n    }\n  }, __jsx(\"i\", {\n    className: \"ion-edit\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 11\n    }\n  }), \" Edit Article\"), __jsx(\"button\", {\n    className: \"btn btn-outline-danger btn-sm\",\n    onClick: handleDelete,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }\n  }, __jsx(\"i\", {\n    className: \"ion-trash-a\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 11\n    }\n  }), \" Delete Article\")));\n};\n\n_s(ArticleActions, \"z2kAO4bAI1j7ZNAc05XiTd69uuI=\", false, function () {\n  return [useSWR, useRouter];\n});\n\n_c = ArticleActions;\nexport default ArticleActions;\n\nvar _c;\n\n$RefreshReg$(_c, \"ArticleActions\");","map":{"version":3,"sources":["/frontend/components/article/ArticleActions.tsx"],"names":["Router","useRouter","React","useSWR","trigger","CustomLink","checkLogin","ArticleAPI","SERVER_BASE_URL","storage","Maybe","ArticleActions","article","currentUser","data","isLoggedIn","router","pid","query","handleDelete","result","window","confirm","token","push","canModify","username","author","slug"],"mappings":";;;;;;;;AAAA,OAAOA,MAAP,IAAiBC,SAAjB,QAAkC,aAAlC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,IAAiBC,OAAjB,QAAgC,KAAhC;AAEA,OAAOC,UAAP,MAAuB,sBAAvB;AACA,OAAOC,UAAP,MAAuB,4BAAvB;AACA,OAAOC,UAAP,MAAuB,uBAAvB;AACA,SAASC,eAAT,QAAgC,0BAAhC;AACA,OAAOC,OAAP,MAAoB,yBAApB;AACA,OAAOC,KAAP,MAAkB,iBAAlB;;AAEA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,OAAiB;AAAA;;AAAA;;AAAA,MAAdC,OAAc,QAAdA,OAAc;;AACtC,gBAA8BT,MAAM,CAAC,MAAD,EAASM,OAAT,CAApC;AAAA,MAAcI,WAAd,WAAQC,IAAR;;AACA,MAAMC,UAAU,GAAGT,UAAU,CAACO,WAAD,CAA7B;AACA,MAAMG,MAAM,GAAGf,SAAS,EAAxB;AACA,MACWgB,GADX,GAEID,MAFJ,CACEE,KADF,CACWD,GADX;;AAIA,MAAME,YAAY;AAAA,yEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACdJ,UADc;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAGbK,cAAAA,MAHa,GAGJC,MAAM,CAACC,OAAP,CAAe,kCAAf,CAHI;;AAAA,kBAKdF,MALc;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,qBAObb,UAAU,UAAV,CAAkBU,GAAlB,EAAuBJ,WAAvB,aAAuBA,WAAvB,uBAAuBA,WAAW,CAAEU,KAApC,CAPa;;AAAA;AAQnBnB,cAAAA,OAAO,WAAII,eAAJ,uBAAgCS,GAAhC,EAAP;AACAjB,cAAAA,MAAM,CAACwB,IAAP;;AATmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAZL,YAAY;AAAA;AAAA;AAAA,KAAlB;;AAYA,MAAMM,SAAS,GACbV,UAAU,IAAI,CAAAF,WAAW,SAAX,IAAAA,WAAW,WAAX,YAAAA,WAAW,CAAEa,QAAb,OAA0Bd,OAA1B,aAA0BA,OAA1B,0CAA0BA,OAAO,CAAEe,MAAnC,oDAA0B,gBAAiBD,QAA3C,CADhB;AAGA,SACE,MAAC,KAAD;AAAO,IAAA,IAAI,EAAED,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,UAAD;AACE,IAAA,IAAI,EAAC,eADP;AAEE,IAAA,EAAE,oBAAab,OAAO,CAACgB,IAArB,CAFJ;AAGE,IAAA,SAAS,EAAC,kCAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAKE;AAAG,IAAA,SAAS,EAAC,UAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALF,kBADF,EASE;AACE,IAAA,SAAS,EAAC,+BADZ;AAEE,IAAA,OAAO,EAAET,YAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAIE;AAAG,IAAA,SAAS,EAAC,aAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJF,oBATF,CADF,CADF;AAoBD,CA3CD;;GAAMR,c;UAC0BR,M,EAEfF,S;;;KAHXU,c;AA6CN,eAAeA,cAAf","sourcesContent":["import Router, { useRouter } from \"next/router\";\nimport React from \"react\";\nimport useSWR, { trigger } from \"swr\";\n\nimport CustomLink from \"../common/CustomLink\";\nimport checkLogin from \"../../lib/utils/checkLogin\";\nimport ArticleAPI from \"../../lib/api/article\";\nimport { SERVER_BASE_URL } from \"../../lib/utils/constant\";\nimport storage from \"../../lib/utils/storage\";\nimport Maybe from \"../common/Maybe\";\n\nconst ArticleActions = ({ article }) => {\n  const { data: currentUser } = useSWR(\"user\", storage);\n  const isLoggedIn = checkLogin(currentUser);\n  const router = useRouter();\n  const {\n    query: { pid },\n  } = router;\n\n  const handleDelete = async () => {\n    if (!isLoggedIn) return;\n\n    const result = window.confirm(\"Do you really want to delete it?\");\n\n    if (!result) return;\n\n    await ArticleAPI.delete(pid, currentUser?.token);\n    trigger(`${SERVER_BASE_URL}/articles/${pid}`);\n    Router.push(`/`);\n  };\n\n  const canModify =\n    isLoggedIn && currentUser?.username === article?.author?.username;\n\n  return (\n    <Maybe test={canModify}>\n      <span>\n        <CustomLink\n          href=\"/editor/[pid]\"\n          as={`/editor/${article.slug}`}\n          className=\"btn btn-outline-secondary btn-sm\"\n        >\n          <i className=\"ion-edit\" /> Edit Article\n        </CustomLink>\n\n        <button\n          className=\"btn btn-outline-danger btn-sm\"\n          onClick={handleDelete}\n        >\n          <i className=\"ion-trash-a\" /> Delete Article\n        </button>\n      </span>\n    </Maybe>\n  );\n};\n\nexport default ArticleActions;\n"]},"metadata":{},"sourceType":"module"}